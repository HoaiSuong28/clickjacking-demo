<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üéÆ Demo T·∫•n C√¥ng & Ph√≤ng Th·ªß</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        .container {
            max-width: 1400px;
            margin: 0 auto;
        }
        h1 {
            color: white;
            text-align: center;
            margin-bottom: 30px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }
        .demo-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(450px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        .demo-card {
            background: white;
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
        }
        .demo-card h2 {
            color: #667eea;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        .demo-card p {
            color: #666;
            margin-bottom: 20px;
            line-height: 1.6;
        }
        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
            font-weight: 600;
            transition: all 0.3s;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }
        .btn-attack {
            background: #ef4444;
            color: white;
        }
        .btn-attack:hover {
            background: #dc2626;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(239, 68, 68, 0.4);
        }
        .btn-defend {
            background: #10b981;
            color: white;
        }
        .btn-defend:hover {
            background: #059669;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(16, 185, 129, 0.4);
        }
        .btn-normal {
            background: #3b82f6;
            color: white;
        }
        .btn-normal:hover {
            background: #2563eb;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(59, 130, 246, 0.4);
        }
        .status-box {
            margin-top: 20px;
            padding: 15px;
            border-radius: 8px;
            background: #f3f4f6;
            min-height: 100px;
            max-height: 300px;
            overflow-y: auto;
        }
        .status-box pre {
            white-space: pre-wrap;
            word-wrap: break-word;
            font-family: 'Courier New', monospace;
            font-size: 13px;
        }
        .iframe-demo {
            width: 100%;
            height: 400px;
            border: 3px solid #ef4444;
            border-radius: 8px;
            margin-top: 15px;
            display: none;
        }
        .iframe-demo.active {
            display: block;
        }
        .alert {
            padding: 15px;
            border-radius: 8px;
            margin: 15px 0;
            font-weight: 600;
        }
        .alert-danger {
            background: #fee2e2;
            color: #991b1b;
            border: 2px solid #ef4444;
        }
        .alert-success {
            background: #d1fae5;
            color: #065f46;
            border: 2px solid #10b981;
        }
        .alert-info {
            background: #dbeafe;
            color: #1e40af;
            border: 2px solid #3b82f6;
        }
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }
        .stat-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
        }
        .stat-number {
            font-size: 36px;
            font-weight: bold;
            margin: 10px 0;
        }
        .stat-label {
            font-size: 14px;
            opacity: 0.9;
        }
        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(255,255,255,.3);
            border-radius: 50%;
            border-top-color: #fff;
            animation: spin 1s ease-in-out infinite;
        }
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üõ°Ô∏è DEMO T·∫§N C√îNG & PH√íNG TH·ª¶ CLICKJACKING + BOT</h1>

        <div class="demo-grid">
            <!-- 1. S·ª≠ d·ª•ng b√¨nh th∆∞·ªùng -->
            <div class="demo-card">
                <h2>‚úÖ Ng∆∞·ªùi D√πng B√¨nh Th∆∞·ªùng</h2>
                <p>
                    M√¥ ph·ªèng ng∆∞·ªùi d√πng th·∫≠t s·ª≠ d·ª•ng website b√¨nh th∆∞·ªùng. 
                    H·ªá th·ªëng <strong>KH√îNG CH·∫∂N</strong> v√¨ kh√¥ng ph√°t hi·ªán h√†nh vi b·∫•t th∆∞·ªùng.
                </p>
                <button class="btn btn-normal" onclick="normalUserAccess()">
                    üë§ Truy c·∫≠p nh∆∞ ng∆∞·ªùi d√πng th∆∞·ªùng
                </button>
                <button class="btn btn-normal" onclick="window.open('http://localhost:3000', '_blank')">
                    üåê M·ªü website ch√≠nh
                </button>
                <div class="status-box" id="normal-status">
                    <pre>Ch∆∞a c√≥ ho·∫°t ƒë·ªông...</pre>
                </div>
            </div>

            <!-- 2. Bot t·∫•n c√¥ng -->
            <div class="demo-card">
                <h2>ü§ñ Bot T·∫•n C√¥ng (DoS)</h2>
                <p>
                    M√¥ ph·ªèng bot t·ª± ƒë·ªông g·ª≠i h√†ng trƒÉm requests/gi√¢y ƒë·ªÉ t·∫•n c√¥ng h·ªá th·ªëng.
                    H·ªá th·ªëng s·∫Ω <strong>PH√ÅT HI·ªÜN V√Ä CH·∫∂N</strong> IP bot.
                </p>
                <button class="btn btn-attack" onclick="startBotAttack()" id="btn-bot">
                    ü§ñ Kh·ªüi ƒë·ªông Bot Attack
                </button>
                <button class="btn btn-defend" onclick="stopBotAttack()">
                    üõë D·ª´ng Bot
                </button>
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-label">Requests g·ª≠i</div>
                        <div class="stat-number" id="bot-requests">0</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-label">B·ªã ch·∫∑n</div>
                        <div class="stat-number" id="bot-blocked">0</div>
                    </div>
                </div>
                <div class="status-box" id="bot-status">
                    <pre>Bot ch∆∞a ƒë∆∞·ª£c kh·ªüi ƒë·ªông...</pre>
                </div>
            </div>

            <!-- 3. Clickjacking Attack -->
            <div class="demo-card">
                <h2>üé≠ Clickjacking Attack</h2>
                <p>
                    M√¥ ph·ªèng trang web gi·∫£ m·∫°o c·ªë g·∫Øng nh√∫ng website v√†o iframe ƒë·ªÉ l·ª´a ƒë·∫£o.
                    H·ªá th·ªëng s·∫Ω <strong>CH·∫∂N IFRAME</strong> v√† hi·ªÉn th·ªã c·∫£nh b√°o.
                </p>
                <button class="btn btn-attack" onclick="demoClickjacking()">
                    üéØ T·∫•n c√¥ng Clickjacking
                </button>
                <button class="btn btn-defend" onclick="hideIframe()">
                    ‚úÖ ƒê√≥ng Demo
                </button>
                <div class="alert alert-danger" id="clickjack-alert" style="display:none;">
                    ‚ö†Ô∏è <strong>PH√ÅT HI·ªÜN T·∫§N C√îNG!</strong><br>
                    Website ƒë√£ CH·∫∂N vi·ªác hi·ªÉn th·ªã trong iframe b·∫±ng X-Frame-Options v√† CSP!
                </div>
                <iframe 
                    id="attack-iframe" 
                    class="iframe-demo"
                    src="http://localhost:3000"
                    sandbox="allow-scripts allow-same-origin">
                </iframe>
                <div class="status-box" id="clickjack-status">
                    <pre>Ch∆∞a th·ª±c hi·ªán demo clickjacking...</pre>
                </div>
            </div>

            <!-- 4. Th·ªëng k√™ real-time -->
            <div class="demo-card">
                <h2>üìä Th·ªëng k√™ Ph√≤ng Th·ªß Real-time</h2>
                <p>
                    Theo d√µi t√¨nh h√¨nh t·∫•n c√¥ng v√† ph√≤ng th·ªß c·ªßa h·ªá th·ªëng theo th·ªùi gian th·ª±c.
                </p>
                <button class="btn btn-defend" onclick="refreshStats()">
                    üîÑ L√†m m·ªõi th·ªëng k√™
                </button>
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-label">T·ªïng t·∫•n c√¥ng</div>
                        <div class="stat-number" id="total-attacks">0</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-label">IP b·ªã ch·∫∑n</div>
                        <div class="stat-number" id="blocked-ips">0</div>
                    </div>
                </div>
                <div class="status-box" id="stats-box">
                    <pre>ƒêang t·∫£i th·ªëng k√™...</pre>
                </div>
            </div>
        </div>
    </div>

    <script>
        const API_BASE = 'http://localhost:5000/api';
        let botInterval = null;
        let statsInterval = null;
        let botRequests = 0;
        let botBlocked = 0;

        // 1. Normal user access
        async function normalUserAccess() {
            const status = document.getElementById('normal-status');
            status.innerHTML = '<pre>‚è≥ ƒêang truy c·∫≠p nh∆∞ ng∆∞·ªùi d√πng th∆∞·ªùng...</pre>';
            
            try {
                const response = await fetch(`${API_BASE}/products?limit=5`);
                const data = await response.json();
                
                status.innerHTML = `<pre>‚úÖ TH√ÄNH C√îNG!\n\nƒê√£ t·∫£i ${data.products.length} s·∫£n ph·∫©m\nTr·∫°ng th√°i: ${response.status}\nKh√¥ng b·ªã ch·∫∑n - S·ª≠ d·ª•ng b√¨nh th∆∞·ªùng!\n\nServer Response Headers:\n${JSON.stringify(Object.fromEntries(response.headers), null, 2)}</pre>`;
            } catch (error) {
                status.innerHTML = `<pre>‚ùå L·ªói: ${error.message}</pre>`;
            }
        }

        // 2. Bot attack
        async function startBotAttack() {
            const btn = document.getElementById('btn-bot');
            const status = document.getElementById('bot-status');
            btn.disabled = true;
            btn.innerHTML = '<span class="loading"></span> Bot ƒëang ch·∫°y...';
            
            botRequests = 0;
            botBlocked = 0;
            
            status.innerHTML = '<pre>ü§ñ Bot attack ƒëang ch·∫°y...\n</pre>';
            
            // G·ª≠i requests li√™n t·ª•c (30 requests/gi√¢y)
            botInterval = setInterval(async () => {
                for (let i = 0; i < 10; i++) {
                    try {
                        const response = await fetch(`${API_BASE}/demo-attack/test`, {
                            method: 'GET'
                        });
                        
                        botRequests++;
                        document.getElementById('bot-requests').textContent = botRequests;
                        
                        if (response.status === 403) {
                            botBlocked++;
                            document.getElementById('bot-blocked').textContent = botBlocked;
                            status.innerHTML += `\nüö´ Request #${botRequests} B·ªä CH·∫∂N (403 Forbidden)`;
                        } else {
                            status.innerHTML += `\n‚úì Request #${botRequests} th√†nh c√¥ng (${response.status})`;
                        }
                        
                        // Gi·ªØ log cu·ªëi
                        const logBox = document.getElementById('bot-status');
                        logBox.scrollTop = logBox.scrollHeight;
                        
                    } catch (error) {
                        status.innerHTML += `\n‚ùå Request #${botRequests} l·ªói: ${error.message}`;
                    }
                }
            }, 100); // 10 requests m·ªói 100ms = 100 requests/gi√¢y
        }

        function stopBotAttack() {
            if (botInterval) {
                clearInterval(botInterval);
                botInterval = null;
                document.getElementById('btn-bot').disabled = false;
                document.getElementById('btn-bot').innerHTML = 'ü§ñ Kh·ªüi ƒë·ªông Bot Attack';
                document.getElementById('bot-status').innerHTML += '\n\nüõë Bot ƒë√£ d·ª´ng!';
            }
        }

        // 3. Clickjacking demo
        function demoClickjacking() {
            const iframe = document.getElementById('attack-iframe');
            const alert = document.getElementById('clickjack-alert');
            const status = document.getElementById('clickjack-status');
            
            iframe.classList.add('active');
            alert.style.display = 'block';
            
            status.innerHTML = `<pre>‚ö†Ô∏è DEMO CLICKJACKING\n\n1. Iframe ƒëang c·ªë g·∫Øng load http://localhost:3000\n2. Ki·ªÉm tra Console c·ªßa trang ƒë·ªÉ th·∫•y l·ªói X-Frame-Options\n3. Website s·∫Ω T·ª™CH·ªêI hi·ªÉn th·ªã trong iframe\n\nM·ªü DevTools (F12) ‚Üí Console ƒë·ªÉ th·∫•y:\n"Refused to display 'http://localhost:3000' in a frame because it set 'X-Frame-Options' to 'deny'."</pre>`;
            
            // Check if iframe loads
            setTimeout(() => {
                try {
                    const iframeDoc = iframe.contentDocument || iframe.contentWindow.document;
                    if (!iframeDoc.body || iframeDoc.body.children.length === 0) {
                        status.innerHTML += '\n\n‚úÖ PH√íNG TH·ª¶ TH√ÄNH C√îNG! Website t·ª´ ch·ªëi load trong iframe!';
                    }
                } catch (e) {
                    status.innerHTML += '\n\n‚úÖ PH√íNG TH·ª¶ TH√ÄNH C√îNG! Cross-origin blocked!';
                }
            }, 2000);
        }

        function hideIframe() {
            document.getElementById('attack-iframe').classList.remove('active');
            document.getElementById('clickjack-alert').style.display = 'none';
        }

        // 4. Stats
        async function refreshStats() {
            const statsBox = document.getElementById('stats-box');
            statsBox.innerHTML = '<pre>‚è≥ ƒêang t·∫£i th·ªëng k√™...</pre>';
            
            try {
                const response = await fetch(`${API_BASE}/bot-stats`);
                const stats = await response.json();
                
                document.getElementById('total-attacks').textContent = stats.botAttacks || 0;
                document.getElementById('blocked-ips').textContent = stats.blockedIPs?.length || 0;
                
                statsBox.innerHTML = `<pre>${JSON.stringify(stats, null, 2)}</pre>`;
            } catch (error) {
                statsBox.innerHTML = `<pre>‚ùå L·ªói: ${error.message}</pre>`;
            }
        }

        // Auto refresh stats every 5 seconds
        setInterval(refreshStats, 5000);
        refreshStats();

        // Cleanup on page unload
        window.addEventListener('beforeunload', () => {
            stopBotAttack();
        });
    </script>
</body>
</html>
